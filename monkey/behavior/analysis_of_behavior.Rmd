---
title: "Behavior"
author: "Fei"
date: "2020/9/6"
output: html_document
---

```{r include=FALSE}
knitr::opts_chunk$set(warning = F, message = F, tidy=F,fig.align='center',fig.showtext=TRUE,results="hold",fig.show = "hold")
library(openxlsx)
library(dplyr)
```


```{r}
setwd("/home/gufei/Desktop/")
filename <- dir(pattern = "*.xlsx")
for (f in filename) {
  # 读取xlsx并取出有用的3列
  data <- subset(read.xlsx(f),type==108 & time>=0, select=c("time","data1","data2"))
  
  # 修改列名称
  names(data)[2:3] <- c("x","y")
  # 时间转化为ms，并且四舍五入
  data <- mutate(data,time=round(time/1000))
  
  # 用日期作为变量名
  result <- paste0("data",substring(f,5,8))
  # 将得到的结果放到对应的变量中
  assign(result,data)
  
}
```


